# 講義「システム情報学概論」サンプルコード

ファイル名：two_balls_on_parabolas_multi.pde

使用言語：Processing

  
  * シミュレーションモデル  
    - 2つの質点（質量同じ）がそれぞれ別の放物線の上を摩擦なしで滑る。
    - 2つの放物線の方程式は以下の通り：
       放物線1：y = +x^2 + 1
       放物線2：y = -x^2 - 1
    - 2つの質点（質点1と質点2）は線形バネで連結されている。
    - バネの自然長と質量はゼロとする。
    - 重力の影響は無視する。  
  
  * 変数の定義
    - この系の自由度は2である。
    - 質点1のx座標をx1,x1の時間微分（=速度のx成分）をv1とする
    - 質点2も同様。
    - 一般化座標(x1,x2,v1,v2)をGeneralCoordsクラスにまとめた。
  
  * この系のラグランジアンは
           L(x1,x2,v1,v2) = (m/2)*(v1^2+4*x1^2*v1^2)
                          + (m/2)*(v2^2+4*x2^2*v2^2)
                          - (k/2)*s^2,
    ここで以下は作業用の変数：
            s = sqrt(dx^2+dy^2), dx=x1-x2, dy=x1^2+x2^2+2.

  * シミュレーション手法
    - ラグランジュの運動方程式をequation_of_motion()関数で解く。
    - 数値積分には古典的な4次ルンゲ・クッタ法を使う。
    - 座標や物理量はfloat（単精度）浮動小数点数として計算している。
    - 精度確認のため全エネルギーを計算・表示する。
  
  * 可視化
    - Processingの線分と円の表示機能を使用。
    - Processingではy軸（+y）の向きが画面の下方向なのでmap関数で反転し、
      y軸+yが画面の上方向になるようにしている。
    - Processingのウィンドウ画面を3つの領域に分割して使う。
    - 細かく言えばこの3つの領域の周囲にヘッダとフッタ領域も確保している。
        +------------+------------+------------+
        |            |            |            |
        |     x-y    |    x1-x2   |   x1-v1    |
        |     plot   |     plot   |  Poincare  |
        |(real space)|(Every time |    map     |
        |            |      steps)| (For v2=0) |
        |            |            |            |
        +------------+------------+------------+
       
  * 使用法
    - 初期条件の設定は setup()関数の以下の部分で変更する。
        balls = new GeneralCoords( 質点1のx座標, その時間微分,
                                   質点2のx座標, その時間微分 )
    - キーボードのuキーで計算（表示）の加速。
    - キーボードのdキーで計算（表示）の減速。
    - キーボードのsキーで計算（表示）の一時停止(stop)と再スタート(start)。
    - マウスクリックもstart/stopのトグル。 
    
  * 開発履歴
    - Akira Kageyama (kage@port.kobe-u.ac.jp)
    - June 29, 2023
